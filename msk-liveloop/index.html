<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="McLaren Labs of San Francisco">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>McLaren Synth Kit - Liveloops - MSK</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/console.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/objc.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/objectivec.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/smalltalk.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">MSK</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Developer <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../setup/" class="dropdown-item">GNUstep Setup</a>
</li>
                                    
<li>
    <a href="../ask-midi/" class="dropdown-item">Alsa Sound Kit - MIDI</a>
</li>
                                    
<li>
    <a href="../ask-pcm/" class="dropdown-item">Alsa Sound Kit - PCM</a>
</li>
                                    
<li>
    <a href="../msk-over/" class="dropdown-item">McLaren Synth Kit - Overview</a>
</li>
                                    
<li>
    <a href="../msk-samples/" class="dropdown-item">McLaren Synth Kit - Samples</a>
</li>
                                    
<li>
    <a href="../msk-metronome/" class="dropdown-item">McLaren Synth Kit - Metronome</a>
</li>
                                    
<li>
    <a href="../msk-pattern/" class="dropdown-item">McLaren Synth Kit - Patterns</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">McLaren Synth Kit - Liveloops</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../conclusion/" class="nav-link">Conclusion</a>
                            </li>
                            <li class="navitem">
                                <a href="../toc/" class="nav-link">Table Of Contents</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../msk-pattern/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../conclusion/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/mclarenlabs/libs-mclaren-alpha/" class="nav-link"><i class="fa fa-github"></i> GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#mclaren-synth-kit-liveloops" class="nav-link">McLaren Synth Kit - Liveloops</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#a-simple-liveloop" class="nav-link">A Simple Liveloop</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#other-operations-on-liveloops" class="nav-link">Other Operations on Liveloops</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#example" class="nav-link">Example</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#contrasting-patterns-and-liveloops" class="nav-link">Contrasting Patterns and Liveloops</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="mclaren-synth-kit-liveloops">McLaren Synth Kit - Liveloops</h1>
<p>We previously described Patterns: a sequence of instructions, possibly with some amount of repetition.  Patterns are of finite length, and cannot be changed while playing.  Liveloops are an extension to Patterns that allows them to be altered while playing --- that is why they are called "live."  A Liveloop can be re-defined and the new definition takes over the next measure so that the music is not interrupted.]</p>
<p>The reason a Liveloop is called what it is comes from two important qualities.</p>
<ul>
<li>"live" - the definition can be changed while it is running</li>
<li>"loop" - it repeats automatically (and forever)</li>
</ul>
<p>Regular patterns don't have either of these characteristics.</p>
<h2 id="a-simple-liveloop">A Simple Liveloop</h2>
<p>In this section we are going to create a simple pattern, start it playing as a Liveloop, and then alter it while it is running.  Our initial pattern will play a low-tom on beats 1 and 3 and a clap on beats 2 and 4.  (See Applications/McLarenSynthKit/MskMetroDemo/Tests/testlive5.m for more details.)</p>
<p>First, we'll load some samples.</p>
<pre><code class="language-objc">MSKSample *tom = [[MSKSample alloc] initWithFilePath:@&quot;./lidtom1.wav&quot; error:&amp;err];
if (err != nil) {
  NSLog(@&quot;could not load sample 'lidtom1.wav'&quot;);
  exit(1);
}

MSKSample *lowtom = [tom resampleBy:1.5]; // lower the pitch

MSKSample *clap = [[MSKSample alloc] initWithFilePath:@&quot;./clap1.wav&quot; error:&amp;err];
if (err != nil) {
  NSLog(@&quot;could not load sample 'clap1.wav'&quot;);
  exit(1);
}

</code></pre>
<p>Then we'll create our simple 4-beat pattern.</p>
<pre><code class="language-objc">MSKPattern *pat = [[MSKPattern alloc] initWithName:@&quot;pat1&quot;];

[pat sync:@&quot;downbeat&quot;];
[pat thunk:^{
  [playSample:lowtom];
  }];

[pat sync:@&quot;beat&quot;];
[pat thunk:^{
  [playSample:clap];
  }];

[pat sync:@&quot;beat&quot;];
[pat thunk:^{
  [playSample:lowtom];
  }];

[pat sync:@&quot;beat&quot;];
[pat thunk:^{
  [playSample:clap];
  }];
</code></pre>
<p>When played, the pattern above first synchronizes with the next downbeat (waiting if it needs to), and then it will play the lowtom/clap/lowtom/clap pattern.  To play it as a live loop we add it to the scheduler with a name.</p>
<pre><code class="language-objc">[_sched Liveloop:@&quot;liveloop1&quot; pat:pat];
</code></pre>
<p>Now, start it playing by using the metronome transport controls.</p>
<pre><code class="language-objc">[_metro start];
</code></pre>
<p>Now let's suppose we would like to replace "pat1" with a different pattern that plays two hand-claps on the "and" of 3 and four.  Call this "pat2".</p>
<pre><code class="language-objc">MSKPattern *pat2 = [[MSKPattern alloc] initWithName:@&quot;pat2&quot;];

[pat sync:@&quot;downbeat&quot;];
[pat thunk:^{
  [playSample:lowtom];
  }];

[pat sync:@&quot;beat&quot;];
[pat thunk:^{
  [playSample:clap];
  }];

[pat sync:@&quot;beat&quot;];
[pat thunk:^{
  [playSample:lowtom];
  }];

[pat ticks:60]; // 60 ticks is an eight note duration
[pat thunk:^{
  [playSample:clap];
  }];

[pat sync:@&quot;beat&quot;];
[pat thunk:^{
  [playSample:clap];
  }];
</code></pre>
<p>The metronome is still running, and the scheduler is still playing the first pattern.  We can replace it while it's running.</p>
<pre><code class="language-objc">[_sched setLiveloop:&quot;liveloop1&quot; pat:pat2];
</code></pre>
<p>Replacing the named liveloop called "liveloop1" causes the following things to happen.  The initial pattern (named "pat1") will play to completion.  The scheduler will then look for the <em>current</em> definition of "liveloop1" from an internal table and it will find "pat2".</p>
<p>The new pattern "pat2" also waits for the next "downbeat" and synchronizes with the metronome and begins its four-beat sequence.  So what we will hear is the transition from "pat1" to "pat2" without any breaks in the rhythm.</p>
<h2 id="other-operations-on-liveloops">Other Operations on Liveloops</h2>
<p>Liveloops can be replaced while they are playing (or when they are not playing).  And they can also be paused and re-enabled.  This is accomplished with the following methods.</p>
<pre><code class="language-objc">[_sched disableLiveloop:@&quot;liveloop1&quot;];

[_sched enableLiveloop:@&quot;liveloop1&quot;];
</code></pre>
<p><strong>DISABLE</strong>
: Disabling a Liveloop sets a flag that instructs the scheduler to <em>not</em> re-start the named liveloop when it finishes playing.  The pattern in the named liveloop will finish what its doing and then stop.</p>
<p><strong>ENABLE</strong>
: Enabling a Liveloop causes it to get launched again.  If the Liveloop is currently playing, then when it reaches the end it will start over.  If it had previously ended, it will be restarted.  The pattern of the liveloop will again synchronize with the metronome using the named events so that no beats will be dropped.</p>
<h2 id="example">Example</h2>
<p>An example of a GUI application that allows starting, stopping, changing, disabling and re-enabling liveloops is in <a href="/Applications/McLarenSynthKit/LiveloopToy">Applications/McLarenSynthKit/LiveloopToy</a>.</p>
<h2 id="contrasting-patterns-and-liveloops">Contrasting Patterns and Liveloops</h2>
<p>[_sched addPattern:pat1];
[_sched setLiveloop:@"loop1" pat:pat1];</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>(c) McLaren Labs 2024</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
